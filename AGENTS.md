Explain Step by Step the codex pipeline.